<!doctype html>
<html>
	<head>
		<script src="closure/goog/base.js"></script>
		<script src="./deps.js"></script>
		<script>
			goog.require('goog.testing.net.XhrIo');
			goog.require('camlistore.ServerConnection');
			goog.require('camlistore.BlobItemContainer');
			goog.require('camlistore.BlobItemContainer.EventType');
		</script>
		<link rel="stylesheet" href="blob_item.css" type="text/css">
	</head>
	<body>
		<script>
			var blobRef = 'sha1-5660088af0aa0d4f2294088f41284002a1baaa29';
			var metaBag = {
				'sha1-5660088af0aa0d4f2294088f41284002a1baaa29': {
			    'blobRef': 'sha1-5660088af0aa0d4f2294088f41284002a1baaa29',
			    'camliType': 'permanode',
			    'mimeType': 'application/json; camliType=permanode',
			    'permanode': {
			      'attr': {
			        'camliContent': ['sha1-c2379bcf77848c90d2c83709aaf7f628a21ff725']
			      }
			    },
			    'size': 556,
			    'thumbnailHeight': 100,
			    'thumbnailSrc': 'thumbnail/sha1-c2379bcf77848c90d2c83709aaf7f628a21ff725/leisure-suit-tony.gif?mw=100&mh=100',
			    'thumbnailWidth': 100
			  },
			  'sha1-c2379bcf77848c90d2c83709aaf7f628a21ff725': {
			    'blobRef': 'sha1-c2379bcf77848c90d2c83709aaf7f628a21ff725',
			    'camliType': 'file',
			    'file': {
			      'size': 37741,
			      'fileName': 'leisure-suit-tony.gif',
			      'mimeType': 'image/gif'
			    },
			    'mimeType': 'application/json; camliType=file',
			    'size': 198
			  }
			};

			var connection = new camlistore.ServerConnection(
				{
					'searchRoot': '/my/test/search'
				},
				goog.testing.net.XhrIo.send
			);

			var container = new camlistore.BlobItemContainer(connection);
			container.render(document.body);
			for (var i = 0; i < 10; i++) {
				container.addChild(new camlistore.BlobItem(blobRef, metaBag), true);
			}

			goog.events.dispatchEvent(
					container, camlistore.BlobItemContainer.EventType.SHOW_RECENT);

			var request = goog.testing.net.XhrIo.getSendInstances().pop();
			request.simulateResponse(
				200,
				JSON.stringify({
					foo: 123
				}));
		</script>
	</body>
</html>
