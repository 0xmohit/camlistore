<!doctype html>
<html>
	<head>
		<link rel="shortcut icon" sizes="16x16" href="safe1-16.png">
		<link rel="shortcut icon" sizes="32x32" href="safe1-32.png">
		<link rel="apple-touch-icon" sizes="16x16" href="safe1-16.png">
		<link rel="apple-touch-icon" sizes="32x32" href="safe1-32.png">

		<script src="closure/goog/base.js"></script>
		<script src="./deps.js"></script>
		<script src="?camli.mode=config&var=CAMLISTORE_CONFIG"></script>

		<script type="text/javascript" src="react/react-with-addons.js"></script>

		<!-- Begin non-Closure cheating; but depended on by server_connection.js -->
		<script type="text/javascript" src="base64.js"></script>
		<script type="text/javascript" src="Crypto.js"></script>
		<script type="text/javascript" src="SHA1.js"></script>
		<!-- End non-Closure cheating -->

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800">
		<link rel="stylesheet" href="detail.css">
	</head>
	<body>
		<script src="detail.js"></script>
		<script>
			goog.require('camlistore.AnimationLoop');
		</script>
		<script>
			var detail = DetailView({
				config: CAMLISTORE_CONFIG,
				blobref: location.search.substring(1),
				width: window.innerWidth,
				height: window.innerHeight
			});
			React.renderComponent(detail, document.body);

			var lastWidth = window.innerWidth;
			var lastHeight = window.innerHeight;

			function maybeUpdate() {
				if (window.innerWidth != lastWidth || window.innerHeight != lastHeight) {
					lastWidth = window.innerWidth;
					lastHeight = window.innerHeight;
					detail.setProps({ width: lastWidth, height: lastHeight});
				}
			}

			var loop = new camlistore.AnimationLoop(window);
			loop.addEventListener('frame', maybeUpdate);
			loop.start();
		</script>
	</body>
</html>
